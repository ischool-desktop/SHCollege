<?xml version="1.0" encoding="utf-8" ?>
<?xml-stylesheet type="text/xsl" href="format.xsl" ?>
<ValidateRule Name="匯入學測報名序號">
  <DuplicateDetection>
    <Detector Name="組合鍵值">
      <Field Name="身分證號" />
      <Field Name="報名序號" />
    <Field Name="學測班級" />
    <Field Name="學測座號" />
    </Detector>
  </DuplicateDetection>
  <FieldList>

    <Field Required="True" Name="身分證號" Description="身分證號">
      <Validate AutoCorrect="False" Description="「身分證號」不允許空白。" ErrorType="Error" Validator="不可空白" When="" />
      <Validate AutoCorrect="False" Description="「身分證號」在一般狀態不存在。" ErrorType="Error" Validator="身分證號是否存在" When="" />
    </Field>
    <!--<Field Required="false" Name="身分證" Description="身分證">

    </Field>-->
    <Field Required="True" Name="報名序號" Description="報名序號，長度必須固定8碼">
      <Validate AutoCorrect="False" Description="「報名序號」序號長度必須8碼。" ErrorType="Error" Validator="長度8" When="" />
      <Validate AutoCorrect="False" Description="「報名序號」序號內容必須8位整數。" ErrorType="Error" Validator="Integer99999999" When="" />
    <Validate AutoCorrect="False" Description="「報名序號」在檔案內重複。" ErrorType="Error" Validator="報名序號在檔案內是否重覆" When="" />
    </Field>
    
    <Field Required="True" Name="學測班級" Description="學測當時學測班級">
      <Validate AutoCorrect="False" Description="「學測班級」班級碼長度必須3碼。" ErrorType="Error" Validator="長度3" When="" />
        <Validate AutoCorrect="False" Description="「學測班級」班級碼內容必須3位整數。" ErrorType="Error" Validator="Integer999" When="" />
    </Field>

    <Field Required="True" Name="學測座號" Description="學測當時學生座號">      
    <Validate AutoCorrect="False" Description="「學測座號」座號內容必須2位整數。" ErrorType="Error" Validator="Integer99" When="" />
    </Field>    
    

  </FieldList>
  <ValidatorList>
    <FieldValidator Name="身分證號是否存在" Type="IMPORTSATSTUDIDNUMBERCHECK"/>
    <FieldValidator Name="報名序號在檔案內是否重覆" Type="SHCOLLEGESATSTUDENTCHECKSAMESERNO"/>
    
    <FieldValidator Name="不可空白" Type="STRINGLENGTH">
      <MinLength>1</MinLength>
    </FieldValidator>
    <FieldValidator Name="長度8" Type="STRINGLENGTH">
      <MinLength>8</MinLength>
      <MinLength>8</MinLength>
    </FieldValidator>
    
        <FieldValidator Name="長度3" Type="STRINGLENGTH">
      <MinLength>3</MinLength>
      <MinLength>3</MinLength>
    </FieldValidator>
            <FieldValidator Name="長度2" Type="STRINGLENGTH">
      <MinLength>2</MinLength>
      <MinLength>2</MinLength>
    </FieldValidator>
      
         <FieldValidator Name="Integer99" Type="Integer">
            <MinValue>1</MinValue>
            <MaxValue>99</MaxValue>
        </FieldValidator>

             <FieldValidator Name="Integer999" Type="Integer">
            <MinValue>1</MinValue>
            <MaxValue>999</MaxValue>
        </FieldValidator>
    
                 <FieldValidator Name="Integer99999999" Type="Integer">
            <MinValue>1</MinValue>
            <MaxValue>99999999</MaxValue>
        </FieldValidator>

      
    <FieldValidator Name="是列舉" Type="Enumeration">
      <Item Value="是">
        <Variation>是</Variation>
      </Item>
    </FieldValidator>
  </ValidatorList>
  <RowValidate>
  </RowValidate>
  <ConditionList />
</ValidateRule>